<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xqxy.dr.modular.event.mapper.ConsBaselineAllMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.xqxy.dr.modular.event.entity.ConsBaselineAll">
        <id column="baseline_id" property="baselineId" />
        <result column="baseline_lib_id" property="baselineLibId" />
        <result column="cons_name" property="consName" />
        <result column="cons_id" property="consId" />
        <result column="baseline_date" property="baselineDate" />
        <result column="simples_date" property="simplesDate" />
        <result column="max_load_baseline" property="maxLoadBaseline" />
        <result column="min_load_baseline" property="minLoadBaseline" />
        <result column="avg_load_baseline" property="avgLoadBaseline" />
        <result column="normal" property="normal" />
        <result column="exception_remark" property="exceptionRemark" />
        <result column="simples_id" property="simplesId" />
        <result column="cal_rule" property="calRule" />
        <result column="p1" property="p1" />
        <result column="p2" property="p2" />
        <result column="p3" property="p3" />
        <result column="p4" property="p4" />
        <result column="p5" property="p5" />
        <result column="p6" property="p6" />
        <result column="p7" property="p7" />
        <result column="p8" property="p8" />
        <result column="p9" property="p9" />
        <result column="p10" property="p10" />
        <result column="p11" property="p11" />
        <result column="p12" property="p12" />
        <result column="p13" property="p13" />
        <result column="p14" property="p14" />
        <result column="p15" property="p15" />
        <result column="p16" property="p16" />
        <result column="p17" property="p17" />
        <result column="p18" property="p18" />
        <result column="p19" property="p19" />
        <result column="p20" property="p20" />
        <result column="p21" property="p21" />
        <result column="p22" property="p22" />
        <result column="p23" property="p23" />
        <result column="p24" property="p24" />
        <result column="p25" property="p25" />
        <result column="p26" property="p26" />
        <result column="p27" property="p27" />
        <result column="p28" property="p28" />
        <result column="p29" property="p29" />
        <result column="p30" property="p30" />
        <result column="p31" property="p31" />
        <result column="p32" property="p32" />
        <result column="p33" property="p33" />
        <result column="p34" property="p34" />
        <result column="p35" property="p35" />
        <result column="p36" property="p36" />
        <result column="p37" property="p37" />
        <result column="p38" property="p38" />
        <result column="p39" property="p39" />
        <result column="p40" property="p40" />
        <result column="p41" property="p41" />
        <result column="p42" property="p42" />
        <result column="p43" property="p43" />
        <result column="p44" property="p44" />
        <result column="p45" property="p45" />
        <result column="p46" property="p46" />
        <result column="p47" property="p47" />
        <result column="p48" property="p48" />
        <result column="p49" property="p49" />
        <result column="p50" property="p50" />
        <result column="p51" property="p51" />
        <result column="p52" property="p52" />
        <result column="p53" property="p53" />
        <result column="p54" property="p54" />
        <result column="p55" property="p55" />
        <result column="p56" property="p56" />
        <result column="p57" property="p57" />
        <result column="p58" property="p58" />
        <result column="p59" property="p59" />
        <result column="p60" property="p60" />
        <result column="p61" property="p61" />
        <result column="p62" property="p62" />
        <result column="p63" property="p63" />
        <result column="p64" property="p64" />
        <result column="p65" property="p65" />
        <result column="p66" property="p66" />
        <result column="p67" property="p67" />
        <result column="p68" property="p68" />
        <result column="p69" property="p69" />
        <result column="p70" property="p70" />
        <result column="p71" property="p71" />
        <result column="p72" property="p72" />
        <result column="p73" property="p73" />
        <result column="p74" property="p74" />
        <result column="p75" property="p75" />
        <result column="p76" property="p76" />
        <result column="p77" property="p77" />
        <result column="p78" property="p78" />
        <result column="p79" property="p79" />
        <result column="p80" property="p80" />
        <result column="p81" property="p81" />
        <result column="p82" property="p82" />
        <result column="p83" property="p83" />
        <result column="p84" property="p84" />
        <result column="p85" property="p85" />
        <result column="p86" property="p86" />
        <result column="p87" property="p87" />
        <result column="p88" property="p88" />
        <result column="p89" property="p89" />
        <result column="p90" property="p90" />
        <result column="p91" property="p91" />
        <result column="p92" property="p92" />
        <result column="p93" property="p93" />
        <result column="p94" property="p94" />
        <result column="p95" property="p95" />
        <result column="p96" property="p96" />
        <result column="state" property="state" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        baseline_id, baseline_lib_id, cons_name, cons_id, baseline_date, simples_date, max_load_baseline, min_load_baseline, avg_load_baseline, normal, exception_remark, simples_id, cal_rule, p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p20, p21, p22, p23, p24, p25, p26, p27, p28, p29, p30, p31, p32, p33, p34, p35, p36, p37, p38, p39, p40, p41, p42, p43, p44, p45, p46, p47, p48, p49, p50, p51, p52, p53, p54, p55, p56, p57, p58, p59, p60, p61, p62, p63, p64, p65, p66, p67, p68, p69, p70, p71, p72, p73, p74, p75, p76, p77, p78, p79, p80, p81, p82, p83, p84, p85, p86, p87, p88, p89, p90, p91, p92, p93, p94, p95, p96, state
    </sql>

    <select id="queryBaseLineByEventAndCons" resultType="com.xqxy.dr.modular.event.entity.ConsBaselineAll">
        SELECT
        base.*
        FROM
        dr_plan_cons planCons
        LEFT JOIN dr_plan plan ON plan.PLAN_ID = planCons.PLAN_ID
        LEFT JOIN dr_event eve ON plan.REGULATE_ID = eve.EVENT_ID
        LEFT JOIN (
            SELECT
                baselineAll.p1, baselineAll.p2, baselineAll.p3, baselineAll.p4, baselineAll.p5, baselineAll.p6, baselineAll.p7, baselineAll.p8, baselineAll.p9, baselineAll.p10,
                baselineAll.p11, baselineAll.p12, baselineAll.p13, baselineAll.p14, baselineAll.p15, baselineAll.p16, baselineAll.p17, baselineAll.p18, baselineAll.p19, baselineAll.p20,
                baselineAll.p21, baselineAll.p22, baselineAll.p23, baselineAll.p24, baselineAll.p25, baselineAll.p26, baselineAll.p27, baselineAll.p28, baselineAll.p29, baselineAll.p30,
                baselineAll.p31, baselineAll.p32, baselineAll.p33, baselineAll.p34, baselineAll.p35, baselineAll.p36, baselineAll.p37, baselineAll.p38, baselineAll.p39, baselineAll.p40,
                baselineAll.p41, baselineAll.p42, baselineAll.p43, baselineAll.p44, baselineAll.p45, baselineAll.p46, baselineAll.p47, baselineAll.p48, baselineAll.p49, baselineAll.p50,
                baselineAll.p51, baselineAll.p52, baselineAll.p53, baselineAll.p54, baselineAll.p55, baselineAll.p56, baselineAll.p57, baselineAll.p58, baselineAll.p59, baselineAll.p60,
                baselineAll.p61, baselineAll.p62, baselineAll.p63, baselineAll.p64, baselineAll.p65, baselineAll.p66, baselineAll.p67, baselineAll.p68, baselineAll.p69, baselineAll.p70,
                baselineAll.p71, baselineAll.p72, baselineAll.p73, baselineAll.p74, baselineAll.p75, baselineAll.p76, baselineAll.p77, baselineAll.p78, baselineAll.p79, baselineAll.p80,
                baselineAll.p81, baselineAll.p82, baselineAll.p83, baselineAll.p84, baselineAll.p85, baselineAll.p86, baselineAll.p87, baselineAll.p88, baselineAll.p89, baselineAll.p90,
                baselineAll.p91, baselineAll.p92, baselineAll.p93, baselineAll.p94, baselineAll.p95, baselineAll.p96,
                baseline.baseline_id
            FROM
                dr_cons_baseline baseline,
                dr_cons_baseline_all baselineAll
            WHERE
                baseline.baseline_lib_id = baselineAll.baseline_lib_id
                AND baseline.cons_id = baselineAll.cons_id
        ) base ON planCons.baseline_cap_id = base.baseline_id
        WHERE
        planCons.deleted = "N"
        AND planCons.INVOLVED_IN = "Y"
        AND planCons.IMPLEMENT = "Y"
        AND (eve.event_status = "03" OR eve.event_status = "04")
        and planCons.cons_id = #{consId}
        and eve.EVENT_ID = #{eventId}
    </select>

</mapper>
