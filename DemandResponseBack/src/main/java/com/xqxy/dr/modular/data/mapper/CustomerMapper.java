package com.xqxy.dr.modular.data.mapper;

import com.xqxy.dr.modular.data.entity.ConsCurve;
import com.xqxy.dr.modular.data.entity.ConsEnergyCurve;
import com.xqxy.sys.modular.cust.entity.Cons;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;
import org.springframework.stereotype.Repository;

import java.util.List;

@Mapper
@Repository
public interface CustomerMapper {

    @Select("select C.CONS_NO \"consId\", C.TRADE_CODE \"tradeCode\", C.CONS_SORT_CODE \"consSortCode\", EMP.p1 * EMP.ct * EMP.pt p1, EMP.p2 * EMP.ct * EMP.pt p2, EMP.p3 * EMP.ct * EMP.pt p3, EMP.p4 * EMP.ct * EMP.pt p4, EMP.p5 * EMP.ct * EMP.pt p5, EMP.p6 * EMP.ct * EMP.pt p6, EMP.p7 * EMP.ct * EMP.pt p7, EMP.p8 * EMP.ct * EMP.pt p8, EMP.p9 * EMP.ct * EMP.pt p9, EMP.p10 * EMP.ct * EMP.pt p10, EMP.p11 * EMP.ct * EMP.pt p11, EMP.p12 * EMP.ct * EMP.pt p12, EMP.p13 * EMP.ct * EMP.pt p13, EMP.p14 * EMP.ct * EMP.pt p14, EMP.p15 * EMP.ct * EMP.pt p15, EMP.p16 * EMP.ct * EMP.pt p16, EMP.p17 * EMP.ct * EMP.pt p17, EMP.p18 * EMP.ct * EMP.pt p18, EMP.p19 * EMP.ct * EMP.pt p19, EMP.p20 * EMP.ct * EMP.pt p20, EMP.p21 * EMP.ct * EMP.pt p21, EMP.p22 * EMP.ct * EMP.pt p22, EMP.p23 * EMP.ct * EMP.pt p23, EMP.p24 * EMP.ct * EMP.pt p24, EMP.p25 * EMP.ct * EMP.pt p25, EMP.p26 * EMP.ct * EMP.pt p26, EMP.p27 * EMP.ct * EMP.pt p27, EMP.p28 * EMP.ct * EMP.pt p28, EMP.p29 * EMP.ct * EMP.pt p29, EMP.p30 * EMP.ct * EMP.pt p30, EMP.p31 * EMP.ct * EMP.pt p31, EMP.p32 * EMP.ct * EMP.pt p32, EMP.p33 * EMP.ct * EMP.pt p33, EMP.p34 * EMP.ct * EMP.pt p34, EMP.p35 * EMP.ct * EMP.pt p35, EMP.p36 * EMP.ct * EMP.pt p36, EMP.p37 * EMP.ct * EMP.pt p37, EMP.p38 * EMP.ct * EMP.pt p38, EMP.p39 * EMP.ct * EMP.pt p39, EMP.p40 * EMP.ct * EMP.pt p40, EMP.p41 * EMP.ct * EMP.pt p41, EMP.p42 * EMP.ct * EMP.pt p42, EMP.p43 * EMP.ct * EMP.pt p43, EMP.p44 * EMP.ct * EMP.pt p44, EMP.p45 * EMP.ct * EMP.pt p45, EMP.p46 * EMP.ct * EMP.pt p46, EMP.p47 * EMP.ct * EMP.pt p47, EMP.p48 * EMP.ct * EMP.pt p48, EMP.p49 * EMP.ct * EMP.pt p49, EMP.p50 * EMP.ct * EMP.pt p50, EMP.p51 * EMP.ct * EMP.pt p51, EMP.p52 * EMP.ct * EMP.pt p52, EMP.p53 * EMP.ct * EMP.pt p53, EMP.p54 * EMP.ct * EMP.pt p54, EMP.p55 * EMP.ct * EMP.pt p55, EMP.p56 * EMP.ct * EMP.pt p56, EMP.p57 * EMP.ct * EMP.pt p57, EMP.p58 * EMP.ct * EMP.pt p58, EMP.p59 * EMP.ct * EMP.pt p59, EMP.p60 * EMP.ct * EMP.pt p60, EMP.p61 * EMP.ct * EMP.pt p61, EMP.p14 * EMP.ct * EMP.pt p62, EMP.p15 * EMP.ct * EMP.pt p63, EMP.p16 * EMP.ct * EMP.pt p64, EMP.p17 * EMP.ct * EMP.pt p65, EMP.p66 * EMP.ct * EMP.pt p66, EMP.p67 * EMP.ct * EMP.pt p67, EMP.p14 * EMP.ct * EMP.pt p68, EMP.p15 * EMP.ct * EMP.pt p69, EMP.p16 * EMP.ct * EMP.pt p70, EMP.p17 * EMP.ct * EMP.pt p71, EMP.p72 * EMP.ct * EMP.pt p72, EMP.p73 * EMP.ct * EMP.pt p73, EMP.p14 * EMP.ct * EMP.pt p74, EMP.p15 * EMP.ct * EMP.pt p75, EMP.p16 * EMP.ct * EMP.pt p76, EMP.p17 * EMP.ct * EMP.pt p77, EMP.p78 * EMP.ct * EMP.pt p78, EMP.p79 * EMP.ct * EMP.pt p79, EMP.p14 * EMP.ct * EMP.pt p80, EMP.p15 * EMP.ct * EMP.pt p81, EMP.p16 * EMP.ct * EMP.pt p82, EMP.p17 * EMP.ct * EMP.pt p83, EMP.p84 * EMP.ct * EMP.pt p84, EMP.p85 * EMP.ct * EMP.pt p85, EMP.p14 * EMP.ct * EMP.pt p86, EMP.p15 * EMP.ct * EMP.pt p87, EMP.p16 * EMP.ct * EMP.pt p88, EMP.p17 * EMP.ct * EMP.pt p89, EMP.p90 * EMP.ct * EMP.pt p90, EMP.p91 * EMP.ct * EMP.pt p91, EMP.p14 * EMP.ct * EMP.pt p92, EMP.p15 * EMP.ct * EMP.pt p93, EMP.p16 * EMP.ct * EMP.pt p94, EMP.p17 * EMP.ct * EMP.pt p95, EMP.p96 * EMP.ct * EMP.pt p96 from fro_amr_ocean_coll.E_MP_POWER_CURVE EMP inner JOIN fro_amr_ocean_arch.R_DATA_MP R on EMP.id = R.id inner JOIN fro_cms_epm_md.C_CONS C on R.CONS_NO = C.CONS_NO WHERE EMP.DATA_TYPE = 1 and EMP.DATA_SRC = '1' and R.DATA_SRC = '1' and C.CONS_NO = #{consNo} and EMP.data_date = to_date(#{dataTime}, 'yyyy-mm-dd hh24:mi:ss')")
    List<ConsCurve> queryDayLoadCurveByConsNo(@Param("consNo") String consNo, @Param("dataTime") String dataTime);

    @Select("select C.CONS_NO consId, C.TRADE_CODE tradeCode, C.CONS_SORT_CODE consSortCode, EMP.DATA_DATE dataDate, EMP.p1 * EMP.ct * EMP.pt p1, EMP.p2 * EMP.ct * EMP.pt p2, EMP.p3 * EMP.ct * EMP.pt p3, EMP.p4 * EMP.ct * EMP.pt p4, EMP.p5 * EMP.ct * EMP.pt p5, EMP.p6 * EMP.ct * EMP.pt p6, EMP.p7 * EMP.ct * EMP.pt p7, EMP.p8 * EMP.ct * EMP.pt p8, EMP.p9 * EMP.ct * EMP.pt p9, EMP.p10 * EMP.ct * EMP.pt p10, EMP.p11 * EMP.ct * EMP.pt p11, EMP.p12 * EMP.ct * EMP.pt p12, EMP.p13 * EMP.ct * EMP.pt p13, EMP.p14 * EMP.ct * EMP.pt p14, EMP.p15 * EMP.ct * EMP.pt p15, EMP.p16 * EMP.ct * EMP.pt p16, EMP.p17 * EMP.ct * EMP.pt p17, EMP.p18 * EMP.ct * EMP.pt p18, EMP.p19 * EMP.ct * EMP.pt p19, EMP.p20 * EMP.ct * EMP.pt p20, EMP.p21 * EMP.ct * EMP.pt p21, EMP.p22 * EMP.ct * EMP.pt p22, EMP.p23 * EMP.ct * EMP.pt p23, EMP.p24 * EMP.ct * EMP.pt p24, EMP.p25 * EMP.ct * EMP.pt p25, EMP.p26 * EMP.ct * EMP.pt p26, EMP.p27 * EMP.ct * EMP.pt p27, EMP.p28 * EMP.ct * EMP.pt p28, EMP.p29 * EMP.ct * EMP.pt p29, EMP.p30 * EMP.ct * EMP.pt p30, EMP.p31 * EMP.ct * EMP.pt p31, EMP.p32 * EMP.ct * EMP.pt p32, EMP.p33 * EMP.ct * EMP.pt p33, EMP.p34 * EMP.ct * EMP.pt p34, EMP.p35 * EMP.ct * EMP.pt p35, EMP.p36 * EMP.ct * EMP.pt p36, EMP.p37 * EMP.ct * EMP.pt p37, EMP.p38 * EMP.ct * EMP.pt p38, EMP.p39 * EMP.ct * EMP.pt p39, EMP.p40 * EMP.ct * EMP.pt p40, EMP.p41 * EMP.ct * EMP.pt p41, EMP.p42 * EMP.ct * EMP.pt p42, EMP.p43 * EMP.ct * EMP.pt p43, EMP.p44 * EMP.ct * EMP.pt p44, EMP.p45 * EMP.ct * EMP.pt p45, EMP.p46 * EMP.ct * EMP.pt p46, EMP.p47 * EMP.ct * EMP.pt p47, EMP.p48 * EMP.ct * EMP.pt p48, EMP.p49 * EMP.ct * EMP.pt p49, EMP.p50 * EMP.ct * EMP.pt p50, EMP.p51 * EMP.ct * EMP.pt p51, EMP.p52 * EMP.ct * EMP.pt p52, EMP.p53 * EMP.ct * EMP.pt p53, EMP.p54 * EMP.ct * EMP.pt p54, EMP.p55 * EMP.ct * EMP.pt p55, EMP.p56 * EMP.ct * EMP.pt p56, EMP.p57 * EMP.ct * EMP.pt p57, EMP.p58 * EMP.ct * EMP.pt p58, EMP.p59 * EMP.ct * EMP.pt p59, EMP.p60 * EMP.ct * EMP.pt p60, EMP.p61 * EMP.ct * EMP.pt p61, EMP.p14 * EMP.ct * EMP.pt p62, EMP.p15 * EMP.ct * EMP.pt p63, EMP.p16 * EMP.ct * EMP.pt p64, EMP.p17 * EMP.ct * EMP.pt p65, EMP.p66 * EMP.ct * EMP.pt p66, EMP.p67 * EMP.ct * EMP.pt p67, EMP.p14 * EMP.ct * EMP.pt p68, EMP.p15 * EMP.ct * EMP.pt p69, EMP.p16 * EMP.ct * EMP.pt p70, EMP.p17 * EMP.ct * EMP.pt p71, EMP.p72 * EMP.ct * EMP.pt p72, EMP.p73 * EMP.ct * EMP.pt p73, EMP.p14 * EMP.ct * EMP.pt p74, EMP.p15 * EMP.ct * EMP.pt p75, EMP.p16 * EMP.ct * EMP.pt p76, EMP.p17 * EMP.ct * EMP.pt p77, EMP.p78 * EMP.ct * EMP.pt p78, EMP.p79 * EMP.ct * EMP.pt p79, EMP.p14 * EMP.ct * EMP.pt p80, EMP.p15 * EMP.ct * EMP.pt p81, EMP.p16 * EMP.ct * EMP.pt p82, EMP.p17 * EMP.ct * EMP.pt p83, EMP.p84 * EMP.ct * EMP.pt p84, EMP.p85 * EMP.ct * EMP.pt p85, EMP.p14 * EMP.ct * EMP.pt p86, EMP.p15 * EMP.ct * EMP.pt p87, EMP.p16 * EMP.ct * EMP.pt p88, EMP.p17 * EMP.ct * EMP.pt p89, EMP.p90 * EMP.ct * EMP.pt p90, EMP.p91 * EMP.ct * EMP.pt p91, EMP.p14 * EMP.ct * EMP.pt p92, EMP.p15 * EMP.ct * EMP.pt p93, EMP.p16 * EMP.ct * EMP.pt p94, EMP.p17 * EMP.ct * EMP.pt p95, EMP.p96 * EMP.ct * EMP.pt p96 from fro_amr_ocean_coll.E_MP_POWER_CURVE EMP inner JOIN fro_amr_ocean_arch.R_DATA_MP R on EMP.id = R.id inner JOIN fro_cms_epm_md.C_CONS C on R.CONS_NO = C.CONS_NO WHERE EMP.DATA_TYPE = 1 and EMP.DATA_SRC = '1' and R.DATA_SRC = '1' and C.CONS_NO = #{consNo} and EMP.data_date >= to_date(#{startDate }, 'yyyy-mm-dd hh24:mi:ss')\n" +
            "and EMP.data_date <= to_date(#{endDate}, 'yyyy-mm-dd hh24:mi:ss')")
    List<ConsCurve> queryHistoryCurveList(@Param("consNo") String elecConsNo, @Param("startDate") String startDate, @Param("endDate") String endDate);
    // 电能量查询接口
    @Select("select C.CONS_NO consId, C.TRADE_CODE tradeCode, C.CONS_SORT_CODE consSortCode, EMP.DATA_DATE dataDate, EMP.p1 * EMP.ct * EMP.pt e1, EMP.p2 * EMP.ct * EMP.pt e2, EMP.p3 * EMP.ct * EMP.pt e3, EMP.p4 * EMP.ct * EMP.pt e4, EMP.p5 * EMP.ct * EMP.pt e5, EMP.p6 * EMP.ct * EMP.pt e6, EMP.p7 * EMP.ct * EMP.pt e7, EMP.p8 * EMP.ct * EMP.pt e8, EMP.p9 * EMP.ct * EMP.pt e9, EMP.p10 * EMP.ct * EMP.pt e10, EMP.p11 * EMP.ct * EMP.pt e11, EMP.p12 * EMP.ct * EMP.pt e12, EMP.p13 * EMP.ct * EMP.pt e13, EMP.p14 * EMP.ct * EMP.pt e14, EMP.p15 * EMP.ct * EMP.pt e15, EMP.p16 * EMP.ct * EMP.pt e16, EMP.p17 * EMP.ct * EMP.pt e17, EMP.p18 * EMP.ct * EMP.pt e18, EMP.p19 * EMP.ct * EMP.pt e19, EMP.p20 * EMP.ct * EMP.pt e20, EMP.p21 * EMP.ct * EMP.pt e21, EMP.p22 * EMP.ct * EMP.pt e22, EMP.p23 * EMP.ct * EMP.pt e23, EMP.p24 * EMP.ct * EMP.pt e24, EMP.p25 * EMP.ct * EMP.pt e25, EMP.p26 * EMP.ct * EMP.pt e26, EMP.p27 * EMP.ct * EMP.pt e27, EMP.p28 * EMP.ct * EMP.pt e28, EMP.p29 * EMP.ct * EMP.pt e29, EMP.p30 * EMP.ct * EMP.pt e30, EMP.p31 * EMP.ct * EMP.pt e31, EMP.p32 * EMP.ct * EMP.pt e32, EMP.p33 * EMP.ct * EMP.pt e33, EMP.p34 * EMP.ct * EMP.pt e34, EMP.p35 * EMP.ct * EMP.pt e35, EMP.p36 * EMP.ct * EMP.pt e36, EMP.p37 * EMP.ct * EMP.pt e37, EMP.p38 * EMP.ct * EMP.pt e38, EMP.p39 * EMP.ct * EMP.pt e39, EMP.p40 * EMP.ct * EMP.pt e40, EMP.p41 * EMP.ct * EMP.pt e41, EMP.p42 * EMP.ct * EMP.pt e42, EMP.p43 * EMP.ct * EMP.pt e43, EMP.p44 * EMP.ct * EMP.pt e44, EMP.p45 * EMP.ct * EMP.pt e45, EMP.p46 * EMP.ct * EMP.pt e46, EMP.p47 * EMP.ct * EMP.pt e47, EMP.p48 * EMP.ct * EMP.pt e48, EMP.p49 * EMP.ct * EMP.pt e49, EMP.p50 * EMP.ct * EMP.pt e50, EMP.p51 * EMP.ct * EMP.pt e51, EMP.p52 * EMP.ct * EMP.pt e52, EMP.p53 * EMP.ct * EMP.pt e53, EMP.p54 * EMP.ct * EMP.pt e54, EMP.p55 * EMP.ct * EMP.pt e55, EMP.p56 * EMP.ct * EMP.pt e56, EMP.p57 * EMP.ct * EMP.pt e57, EMP.p58 * EMP.ct * EMP.pt e58, EMP.p59 * EMP.ct * EMP.pt e59, EMP.p60 * EMP.ct * EMP.pt e60, EMP.p61 * EMP.ct * EMP.pt e61, EMP.p14 * EMP.ct * EMP.pt e62, EMP.p15 * EMP.ct * EMP.pt e63, EMP.p16 * EMP.ct * EMP.pt e64, EMP.p17 * EMP.ct * EMP.pt e65, EMP.p66 * EMP.ct * EMP.pt e66, EMP.p67 * EMP.ct * EMP.pt e67, EMP.p14 * EMP.ct * EMP.pt e68, EMP.p15 * EMP.ct * EMP.pt e69, EMP.p16 * EMP.ct * EMP.pt e70, EMP.p17 * EMP.ct * EMP.pt e71, EMP.p72 * EMP.ct * EMP.pt e72, EMP.p73 * EMP.ct * EMP.pt e73, EMP.p14 * EMP.ct * EMP.pt e74, EMP.p15 * EMP.ct * EMP.pt e75, EMP.p16 * EMP.ct * EMP.pt e76, EMP.p17 * EMP.ct * EMP.pt e77, EMP.p78 * EMP.ct * EMP.pt e78, EMP.p79 * EMP.ct * EMP.pt e79, EMP.p14 * EMP.ct * EMP.pt e80, EMP.p15 * EMP.ct * EMP.pt e81, EMP.p16 * EMP.ct * EMP.pt e82, EMP.p17 * EMP.ct * EMP.pt e83, EMP.p84 * EMP.ct * EMP.pt e84, EMP.p85 * EMP.ct * EMP.pt e85, EMP.p14 * EMP.ct * EMP.pt e86, EMP.p15 * EMP.ct * EMP.pt e87, EMP.p16 * EMP.ct * EMP.pt e88, EMP.p17 * EMP.ct * EMP.pt e89, EMP.p90 * EMP.ct * EMP.pt e90, EMP.p91 * EMP.ct * EMP.pt e91, EMP.p14 * EMP.ct * EMP.pt e92, EMP.p15 * EMP.ct * EMP.pt e93, EMP.p16 * EMP.ct * EMP.pt e94, EMP.p17 * EMP.ct * EMP.pt e95, EMP.p96 * EMP.ct * EMP.pt e96 from fro_amr_ocean_coll.E_MP_POWER_CURVE EMP inner JOIN fro_amr_ocean_arch.R_DATA_MP R on EMP.id = R.id inner JOIN fro_cms_epm_md.C_CONS C on R.CONS_NO = C.CONS_NO WHERE EMP.DATA_TYPE = 8 and EMP.DATA_SRC = '1' and R.DATA_SRC = '1' and C.CONS_SORT_CODE in ('01', '02') and C.CONS_NO = #{consNo} and EMP.data_date = to_date(#{dataDate}, 'yyyy-mm-dd hh24:mi:ss')")
    ConsEnergyCurve queryDayLoadEnergyByConsNo(@Param("consNo") String elecConsNo, @Param("dataDate") String dataDate);

    Cons getConsFromMarketing(@Param("consNo") String elecNo, @Param("consName") String consName, @Param("orgNo") String orgNo);
}
